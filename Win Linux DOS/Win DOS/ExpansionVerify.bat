@ECHO OFF
CHCP 936
TITLE 参变检测仪
CLS
IF /I "%SYSTEMDRIVE%"=="X:" (ECHO Windows PE下若能看到此消息，则说明Windows PE没有参变。&PAUSE&EXIT)
IF NOT EXIST "%COMSPEC:~0,-7%mshta.exe" (ECHO 系统文件mshta.exe意外丢失，您的系统已参变！)
MSHTA VBSCRIPT:MSGBOX("若若若若若",16,"参参参参参变变变变变检检检检检测测测测测仪仪仪仪仪")(WINDOW.CLOSE)
MSHTA VBSCRIPT:MSGBOX("您您您您您",16,"参参参参参变变变变变检检检检检测测测测测仪仪仪仪仪")(WINDOW.CLOSE)
MSHTA VBSCRIPT:MSGBOX("看看看看看",16,"参参参参参变变变变变检检检检检测测测测测仪仪仪仪仪")(WINDOW.CLOSE)
MSHTA VBSCRIPT:MSGBOX("到到到到到",16,"参参参参参变变变变变检检检检检测测测测测仪仪仪仪仪")(WINDOW.CLOSE)
MSHTA VBSCRIPT:MSGBOX("的的的的的",16,"参参参参参变变变变变检检检检检测测测测测仪仪仪仪仪")(WINDOW.CLOSE)
MSHTA VBSCRIPT:MSGBOX("不不不不不",16,"参参参参参变变变变变检检检检检测测测测测仪仪仪仪仪")(WINDOW.CLOSE)
MSHTA VBSCRIPT:MSGBOX("是是是是是",16,"参参参参参变变变变变检检检检检测测测测测仪仪仪仪仪")(WINDOW.CLOSE)
MSHTA VBSCRIPT:MSGBOX("55555",16,"参参参参参变变变变变检检检检检测测测测测仪仪仪仪仪")(WINDOW.CLOSE)
MSHTA VBSCRIPT:MSGBOX("个个个个个",16,"参参参参参变变变变变检检检检检测测测测测仪仪仪仪仪")(WINDOW.CLOSE)
MSHTA VBSCRIPT:MSGBOX("55555",16,"参参参参参变变变变变检检检检检测测测测测仪仪仪仪仪")(WINDOW.CLOSE)
MSHTA VBSCRIPT:MSGBOX("个个个个个",16,"参参参参参变变变变变检检检检检测测测测测仪仪仪仪仪")(WINDOW.CLOSE)
MSHTA VBSCRIPT:MSGBOX("出出出出出",16,"参参参参参变变变变变检检检检检测测测测测仪仪仪仪仪")(WINDOW.CLOSE)
MSHTA VBSCRIPT:MSGBOX("现现现现现",16,"参参参参参变变变变变检检检检检测测测测测仪仪仪仪仪")(WINDOW.CLOSE)
MSHTA VBSCRIPT:MSGBOX("的的的的的",16,"参参参参参变变变变变检检检检检测测测测测仪仪仪仪仪")(WINDOW.CLOSE)
MSHTA VBSCRIPT:MSGBOX("字字字字字",16,"参参参参参变变变变变检检检检检测测测测测仪仪仪仪仪")(WINDOW.CLOSE)
MSHTA VBSCRIPT:MSGBOX("符符符符符",16,"参参参参参变变变变变检检检检检测测测测测仪仪仪仪仪")(WINDOW.CLOSE)
MSHTA VBSCRIPT:MSGBOX("、、、、、",16,"参参参参参变变变变变检检检检检测测测测测仪仪仪仪仪")(WINDOW.CLOSE)
MSHTA VBSCRIPT:MSGBOX("按按按按按",16,"参参参参参变变变变变检检检检检测测测测测仪仪仪仪仪")(WINDOW.CLOSE)
MSHTA VBSCRIPT:MSGBOX("钮钮钮钮钮",16,"参参参参参变变变变变检检检检检测测测测测仪仪仪仪仪")(WINDOW.CLOSE)
MSHTA VBSCRIPT:MSGBOX("不不不不不",16,"参参参参参变变变变变检检检检检测测测测测仪仪仪仪仪")(WINDOW.CLOSE)
MSHTA VBSCRIPT:MSGBOX("唯唯唯唯唯",16,"参参参参参变变变变变检检检检检测测测测测仪仪仪仪仪")(WINDOW.CLOSE)
MSHTA VBSCRIPT:MSGBOX("一一一一一",16,"参参参参参变变变变变检检检检检测测测测测仪仪仪仪仪")(WINDOW.CLOSE)
MSHTA VBSCRIPT:MSGBOX("、、、、、",16,"参参参参参变变变变变检检检检检测测测测测仪仪仪仪仪")(WINDOW.CLOSE)
MSHTA VBSCRIPT:MSGBOX("未未未未未",16,"参参参参参变变变变变检检检检检测测测测测仪仪仪仪仪")(WINDOW.CLOSE)
MSHTA VBSCRIPT:MSGBOX("看看看看看",16,"参参参参参变变变变变检检检检检测测测测测仪仪仪仪仪")(WINDOW.CLOSE)
MSHTA VBSCRIPT:MSGBOX("见见见见见",16,"参参参参参变变变变变检检检检检测测测测测仪仪仪仪仪")(WINDOW.CLOSE)
MSHTA VBSCRIPT:MSGBOX("错错错错错",16,"参参参参参变变变变变检检检检检测测测测测仪仪仪仪仪")(WINDOW.CLOSE)
MSHTA VBSCRIPT:MSGBOX("误误误误误",16,"参参参参参变变变变变检检检检检测测测测测仪仪仪仪仪")(WINDOW.CLOSE)
MSHTA VBSCRIPT:MSGBOX("提提提提提",16,"参参参参参变变变变变检检检检检测测测测测仪仪仪仪仪")(WINDOW.CLOSE)
MSHTA VBSCRIPT:MSGBOX("示示示示示",16,"参参参参参变变变变变检检检检检测测测测测仪仪仪仪仪")(WINDOW.CLOSE)
MSHTA VBSCRIPT:MSGBOX("框框框框框",16,"参参参参参变变变变变检检检检检测测测测测仪仪仪仪仪")(WINDOW.CLOSE)
MSHTA VBSCRIPT:MSGBOX("或或或或或",16,"参参参参参变变变变变检检检检检测测测测测仪仪仪仪仪")(WINDOW.CLOSE)
MSHTA VBSCRIPT:MSGBOX("未未未未未",16,"参参参参参变变变变变检检检检检测测测测测仪仪仪仪仪")(WINDOW.CLOSE)
MSHTA VBSCRIPT:MSGBOX("听听听听听",16,"参参参参参变变变变变检检检检检测测测测测仪仪仪仪仪")(WINDOW.CLOSE)
MSHTA VBSCRIPT:MSGBOX("见见见见见",16,"参参参参参变变变变变检检检检检测测测测测仪仪仪仪仪")(WINDOW.CLOSE)
MSHTA VBSCRIPT:MSGBOX("错错错错错",16,"参参参参参变变变变变检检检检检测测测测测仪仪仪仪仪")(WINDOW.CLOSE)
MSHTA VBSCRIPT:MSGBOX("误误误误误",16,"参参参参参变变变变变检检检检检测测测测测仪仪仪仪仪")(WINDOW.CLOSE)
MSHTA VBSCRIPT:MSGBOX("提提提提提",16,"参参参参参变变变变变检检检检检测测测测测仪仪仪仪仪")(WINDOW.CLOSE)
MSHTA VBSCRIPT:MSGBOX("示示示示示",16,"参参参参参变变变变变检检检检检测测测测测仪仪仪仪仪")(WINDOW.CLOSE)
MSHTA VBSCRIPT:MSGBOX("音音音音音",16,"参参参参参变变变变变检检检检检测测测测测仪仪仪仪仪")(WINDOW.CLOSE)
MSHTA VBSCRIPT:MSGBOX("，，，，，",16,"参参参参参变变变变变检检检检检测测测测测仪仪仪仪仪")(WINDOW.CLOSE)
MSHTA VBSCRIPT:MSGBOX("说说说说说",16,"参参参参参变变变变变检检检检检测测测测测仪仪仪仪仪")(WINDOW.CLOSE)
MSHTA VBSCRIPT:MSGBOX("明明明明明",16,"参参参参参变变变变变检检检检检测测测测测仪仪仪仪仪")(WINDOW.CLOSE)
MSHTA VBSCRIPT:MSGBOX("程程程程程",16,"参参参参参变变变变变检检检检检测测测测测仪仪仪仪仪")(WINDOW.CLOSE)
MSHTA VBSCRIPT:MSGBOX("序序序序序",16,"参参参参参变变变变变检检检检检测测测测测仪仪仪仪仪")(WINDOW.CLOSE)
MSHTA VBSCRIPT:MSGBOX("已已已已已",16,"参参参参参变变变变变检检检检检测测测测测仪仪仪仪仪")(WINDOW.CLOSE)
MSHTA VBSCRIPT:MSGBOX("参参参参参",16,"参参参参参变变变变变检检检检检测测测测测仪仪仪仪仪")(WINDOW.CLOSE)
MSHTA VBSCRIPT:MSGBOX("变变变变变",16,"参参参参参变变变变变检检检检检测测测测测仪仪仪仪仪")(WINDOW.CLOSE)
MSHTA VBSCRIPT:MSGBOX("！！！！！",16,"参参参参参变变变变变检检检检检测测测测测仪仪仪仪仪")(WINDOW.CLOSE)
MSHTA VBSCRIPT:MSGBOX("上述文本为：“若您看到的不是5个5个出现的字符、按钮不唯一、未看见错误提示框或未听见错误提示音，说明程序已参变！”请校准。",16,"参变检测仪")(WINDOW.CLOSE)
ECHO 参变检测仪1%%2^&3^>4↑5A
MSHTA VBSCRIPT:MSGBOX("请看黑色的窗口，若显示的内容不为“参变检测仪1%%2&3>4↑5A”，说明cmd窗口已参变！",16,"参变检测仪")(WINDOW.CLOSE)
CLS
MSHTA VBSCRIPT:MSGBOX("若以上过程无误，则说明本检验程序暂无参变，请迅速完成以下过程：",16,"参变检测仪")(WINDOW.CLOSE)
COLOR CE
ECHO 1．若屏幕背景为红色，文字为黄色，请点击“确定”；
MSHTA VBSCRIPT:MSGBOX("1．若屏幕背景为红色，文字为黄色，请点击“确定”；",16,"参变检测仪")(WINDOW.CLOSE)
SET A=1
SET B=3
SET /A C=A+B
SET /A D=C/2
SET E=16
SET /A F=A+E
SET /A G=A*100+B*1
SET /A H=D+F+G
ECHO 2．计算得2+17+103=%H%，无误请点击“确定”；
MSHTA VBSCRIPT:MSGBOX("2．计算得2+17+103=%H%，无误请点击“确定”；",16,"参变检测仪")(WINDOW.CLOSE)
ECHO ^%A%>"%~DP0ExpansionTEMP.TXT"
ECHO ^%B%>>"%~DP0ExpansionTEMP.TXT"
ECHO 1%%2^&3^>4 5Z>>"%~DP0ExpansionTEMP.TXT"
ATTRIB +A +H +R +S "%~DP0ExpansionTEMP.TXT"
CLS
START /REALTIME "若弹出记事本的同时没有看到校准数据，说明您的系统存在参变！" NOTEPAD "%~DP0ExpansionTEMP.TXT"
ECHO 3．请校准，内容如下：
ECHO    1
ECHO    3
ECHO    1%%2^&3^>4 5Z
ECHO 系统返回的数据：
FOR /F "delims=" %%i in ('TYPE "%~DP0ExpansionTEMP.TXT"') do (@ECHO    %%i)
ECHO 请确认数据无误，无误请点击“确定”。
MSHTA VBSCRIPT:MSGBOX("3．请校准，内容如下（“←”表示换行）：“1←3←1%%2&3>4 5Z”。请确认数据无误，无误请点击“确定”。",16,"参变检测仪")(WINDOW.CLOSE)
DEL /A /F /Q "%~DP0ExpansionTEMP.TXT"
"%~DP0ExpansionENSURE" /YES
ECHO 您的系统存在运行参变！
MSHTA VBSCRIPT:MSGBOX("您的系统存在运行参变！",16,"参变检测仪")(WINDOW.CLOSE)
TASKKILL /IM CMD.EXE /NOTEPAD.EXE /F /T
ECHO 您的系统存在严重运行参变！
MSHTA VBSCRIPT:MSGBOX("您的系统存在严重运行参变！",16,"参变检测仪")(WINDOW.CLOSE)
EXIT